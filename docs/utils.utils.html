---

title: Utils


keywords: fastai
sidebar: home_sidebar



nb_path: "nbs/utils.utils.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/utils.utils.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="make_reproducible">make_reproducible<a class="anchor-link" href="#make_reproducible"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="make_reproducible" class="doc_header"><code>make_reproducible</code><a href="https://github.com/Jaume-JCI/block_types/blob/main/block_types/utils/utils.py#L21" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>make_reproducible</code>()</p>
</blockquote>

<pre><code>Make results obtained from neural network model reproducible.

This function should be run at the very beginning. The result
of calling this is that the pipeline produces the exact same
results as previous runs.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="set_logger">set_logger<a class="anchor-link" href="#set_logger"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="set_logger" class="doc_header"><code>set_logger</code><a href="https://github.com/Jaume-JCI/block_types/blob/main/block_types/utils/utils.py#L51" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>set_logger</code>(<strong><code>name</code></strong>, <strong><code>path_results</code></strong>=<em><code>'log'</code></em>, <strong><code>stdout</code></strong>=<em><code>True</code></em>, <strong><code>mode</code></strong>=<em><code>'w'</code></em>, <strong><code>just_message</code></strong>=<em><code>False</code></em>, <strong><code>filename</code></strong>=<em><code>'logs.txt'</code></em>, <strong><code>logging_level</code></strong>=<em><code>10</code></em>, <strong><code>verbose</code></strong>=<em><code>None</code></em>)</p>
</blockquote>

<pre><code>Set logger.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="remove_previous_results">remove_previous_results<a class="anchor-link" href="#remove_previous_results"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="remove_previous_results" class="doc_header"><code>remove_previous_results</code><a href="https://github.com/Jaume-JCI/block_types/blob/main/block_types/utils/utils.py#L87" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>remove_previous_results</code>(<strong><code>path_results</code></strong>=<em><code>None</code></em>)</p>
</blockquote>

<pre><code>Remove folder containing previous results, if exists.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="set_tf_loglevel">set_tf_loglevel<a class="anchor-link" href="#set_tf_loglevel"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="set_tf_loglevel" class="doc_header"><code>set_tf_loglevel</code><a href="https://github.com/Jaume-JCI/block_types/blob/main/block_types/utils/utils.py#L93" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>set_tf_loglevel</code>(<strong><code>level</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="store_attrs">store_attrs<a class="anchor-link" href="#store_attrs"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="argnames" class="doc_header"><code>argnames</code><a href="https://github.com/Jaume-JCI/block_types/blob/main/block_types/utils/utils.py#L107" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>argnames</code>(<strong><code>f</code></strong>, <strong><code>frame</code></strong>=<em><code>False</code></em>)</p>
</blockquote>

<pre><code>Names of arguments to function or frame `f`</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_specific_dict_param" class="doc_header"><code>get_specific_dict_param</code><a href="https://github.com/Jaume-JCI/block_types/blob/main/block_types/utils/utils.py#L123" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_specific_dict_param</code>(<strong>**<code>kwargs</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="obtain_class_specific_attrs" class="doc_header"><code>obtain_class_specific_attrs</code><a href="https://github.com/Jaume-JCI/block_types/blob/main/block_types/utils/utils.py#L145" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>obtain_class_specific_attrs</code>(<strong>**<code>kwargs</code></strong>)</p>
</blockquote>

<pre><code>Overwrites parameters in kwargs with those found in a dictionary of the same name
given to this component.

Checks if there is a parameter whose name is the name of the class or the name given
to this component. In that case, it overwrites the parameters in kwargs with those
found in that dictionary. The parameters in kwargs can be used as *global* parameters
for multiple components, while parameters specific of one component can be set using
a dictionary with the name of that component. See example below.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_hierarchy_level" class="doc_header"><code>get_hierarchy_level</code><a href="https://github.com/Jaume-JCI/block_types/blob/main/block_types/utils/utils.py#L165" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_hierarchy_level</code>(<strong><code>base_class</code></strong>=<em><code>object</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">f</span> <span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">B</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">A</span> <span class="p">():</span>
    <span class="k">def</span> <span class="fm">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hierarchy_level</span> <span class="o">=</span> <span class="n">get_hierarchy_level</span><span class="p">(</span><span class="n">base_class</span><span class="o">=</span><span class="n">A</span><span class="p">)</span>
        
<span class="k">class</span> <span class="nc">B</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span> <span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ab</span> <span class="o">=</span> <span class="n">A</span> <span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="n">B</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span> <span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">D</span><span class="p">(</span><span class="n">C</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span> <span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c</span> <span class="o">=</span> <span class="n">C</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="p">()</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">B</span><span class="p">()</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">D</span><span class="p">()</span>

<span class="k">assert</span> <span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">hierarchy_level</span><span class="o">==</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">b</span><span class="o">.</span><span class="n">hierarchy_level</span><span class="o">==</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">c</span><span class="o">.</span><span class="n">hierarchy_level</span><span class="o">==</span><span class="mi">0</span>
        <span class="ow">and</span> <span class="n">c</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">hierarchy_level</span><span class="o">==</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">c</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">hierarchy_level</span><span class="o">==</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">c</span><span class="o">.</span><span class="n">ab</span><span class="o">.</span><span class="n">hierarchy_level</span><span class="o">==</span><span class="mi">1</span> 
        <span class="ow">and</span> <span class="n">c</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">ab</span><span class="o">.</span><span class="n">hierarchy_level</span><span class="o">==</span><span class="mi">2</span> 
        <span class="ow">and</span> <span class="n">d</span><span class="o">.</span><span class="n">hierarchy_level</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">d</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">hierarchy_level</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">d</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">hierarchy_level</span> <span class="o">==</span> <span class="mi">1</span>
        <span class="ow">and</span> <span class="n">d</span><span class="o">.</span><span class="n">ab</span><span class="o">.</span><span class="n">hierarchy_level</span> <span class="o">==</span> <span class="mi">1</span> 
        <span class="ow">and</span> <span class="n">d</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">hierarchy_level</span><span class="o">==</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">d</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">ab</span><span class="o">.</span><span class="n">hierarchy_level</span><span class="o">==</span><span class="mi">2</span> <span class="ow">and</span> <span class="n">d</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">ab</span><span class="o">.</span><span class="n">hierarchy_level</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="replace_attr_and_store" class="doc_header"><code>replace_attr_and_store</code><a href="https://github.com/Jaume-JCI/block_types/blob/main/block_types/utils/utils.py#L188" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>replace_attr_and_store</code>(<strong><code>names</code></strong>=<em><code>None</code></em>, <strong><code>but</code></strong>=<em><code>''</code></em>, <strong><code>store_args</code></strong>=<em><code>None</code></em>, <strong><code>recursive</code></strong>=<em><code>True</code></em>, <strong><code>base_class</code></strong>=<em><code>object</code></em>, <strong><code>replace_generic_attr</code></strong>=<em><code>True</code></em>, <strong>**<code>attrs</code></strong>)</p>
</blockquote>

<pre><code>Replaces generic attributes and stores them into attrs in `self`.

If kwargs contains an attribute called the same way as the class of
self, all the keys in that dictionary are considered class-specific
attributes whose value overwrites any attribute in kwargs of the same
name.

The function is called recursively in the hierarchy of parent classes,
from the leaf to the root class, until it reaches an ascendant that
is not an instance of `base_class`.

Most of the implementation is taken from fastcore library, `store_attrs`
function.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pytest</span>

<span class="k">def</span> <span class="nf">f</span> <span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">B</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">A</span> <span class="p">():</span>
    <span class="k">def</span> <span class="fm">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">replace_attr_and_store</span> <span class="p">(</span><span class="n">base_class</span><span class="o">=</span><span class="n">A</span><span class="p">)</span>
        
<span class="k">class</span> <span class="nc">B</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span> <span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ab</span> <span class="o">=</span> <span class="n">A</span> <span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span> <span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="p">()</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">B</span><span class="p">()</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>

<span class="k">assert</span> <span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="o">==</span><span class="mi">3</span> <span class="ow">and</span> <span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">==</span><span class="mi">10</span> <span class="ow">and</span> <span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">==</span><span class="mi">3</span> <span class="ow">and</span> <span class="n">c</span><span class="o">.</span><span class="n">z</span><span class="o">==</span><span class="mi">100</span> <span class="ow">and</span> <span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="o">==</span><span class="mi">3</span> <span class="ow">and</span> <span class="n">c</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="o">==</span><span class="mi">3</span> <span class="ow">and</span> <span class="n">c</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">==</span><span class="mi">10</span> <span class="ow">and</span> <span class="n">c</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">==</span><span class="mi">3</span>

<span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">):</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>

<span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">):</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>

<span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">):</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>

<span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">):</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>

<span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">):</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">ab</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

