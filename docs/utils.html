---

title: Utils


keywords: fastai
sidebar: home_sidebar



nb_path: "nbs/utils/utils.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/utils/utils.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pytest</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="make_reproducible">make_reproducible<a class="anchor-link" href="#make_reproducible"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="make_reproducible" class="doc_header"><code>make_reproducible</code><a href="https://github.com/Jaume-JCI/block-types/tree/main/block_types/utils/utils.py#L22" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>make_reproducible</code>()</p>
</blockquote>

<pre><code>Make results obtained from neural network model reproducible.

This function should be run at the very beginning. The result
of calling this is that the pipeline produces the exact same
results as previous runs.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Usage-example">Usage example<a class="anchor-link" href="#Usage-example"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="test_make_reproducible" class="doc_header"><code>test_make_reproducible</code><a href="https://github.com/Jaume-JCI/block-types/tree/main/block_types/tests/utils/test_utils.py#L26" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>test_make_reproducible</code>()</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#@pytest.mark.reference_fails</span>
<span class="k">def</span> <span class="nf">test_make_reproducible</span> <span class="p">():</span>
    <span class="n">make_reproducible</span> <span class="p">()</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">make_reproducible</span> <span class="p">()</span>
    <span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="k">assert</span> <span class="p">(</span><span class="n">x</span><span class="o">==</span><span class="n">x2</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tst</span><span class="o">.</span><span class="n">run</span> <span class="p">(</span><span class="n">test_make_reproducible</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s1">&#39;dummy&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>running test_make_reproducible
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2022-02-02 11:37:42.793921: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library &#39;libcudart.so.11.0&#39;; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2018.1.163/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2018.1.163/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2018.1.163/linux/mkl/lib/intel64_lin:/opt/intel/compilers_and_libraries_2018.1.163/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2018.1.163/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2018.1.163/linux/mkl/lib/intel64_lin::/usr/local/cuda/lib64:/usr/local/cuda/extras/CUPTI/lib64/:/usr/local/cuda/lib64:/usr/local/cuda/extras/CUPTI/lib64/
2022-02-02 11:37:42.793961: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="set_logger">set_logger<a class="anchor-link" href="#set_logger"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="get_logging_level">get_logging_level<a class="anchor-link" href="#get_logging_level"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_logging_level" class="doc_header"><code>get_logging_level</code><a href="https://github.com/Jaume-JCI/block-types/tree/main/block_types/utils/utils.py#L52" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_logging_level</code>(<strong><code>verbose</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="delete_logger">delete_logger<a class="anchor-link" href="#delete_logger"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="delete_logger" class="doc_header"><code>delete_logger</code><a href="https://github.com/Jaume-JCI/block-types/tree/main/block_types/utils/utils.py#L56" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>delete_logger</code>(<strong><code>name</code></strong>, <strong><code>path_results</code></strong>=<em><code>'log'</code></em>, <strong><code>filename</code></strong>=<em><code>'logs.txt'</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="set_logger">set_logger<a class="anchor-link" href="#set_logger"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="set_logger" class="doc_header"><code>set_logger</code><a href="https://github.com/Jaume-JCI/block-types/tree/main/block_types/utils/utils.py#L63" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>set_logger</code>(<strong><code>name</code></strong>, <strong><code>path_results</code></strong>=<em><code>'log'</code></em>, <strong><code>stdout</code></strong>=<em><code>True</code></em>, <strong><code>mode</code></strong>=<em><code>'a'</code></em>, <strong><code>just_message</code></strong>=<em><code>False</code></em>, <strong><code>filename</code></strong>=<em><code>'logs.txt'</code></em>, <strong><code>logging_level</code></strong>=<em><code>10</code></em>, <strong><code>verbose</code></strong>=<em><code>None</code></em>, <strong><code>verbose_out</code></strong>=<em><code>None</code></em>, <strong><code>print_path</code></strong>=<em><code>False</code></em>)</p>
</blockquote>

<pre><code>Set logger.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="set_empty_logger">set_empty_logger<a class="anchor-link" href="#set_empty_logger"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="set_empty_logger" class="doc_header"><code>set_empty_logger</code><a href="https://github.com/Jaume-JCI/block-types/tree/main/block_types/utils/utils.py#L111" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>set_empty_logger</code>()</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="set_verbosity">set_verbosity<a class="anchor-link" href="#set_verbosity"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="set_verbosity" class="doc_header"><code>set_verbosity</code><a href="https://github.com/Jaume-JCI/block-types/tree/main/block_types/utils/utils.py#L115" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>set_verbosity</code>(<strong><code>name</code></strong>=<em><code>None</code></em>, <strong><code>logger</code></strong>=<em><code>None</code></em>, <strong><code>logging_level</code></strong>=<em><code>10</code></em>, <strong><code>verbose</code></strong>=<em><code>None</code></em>, <strong><code>verbose_out</code></strong>=<em><code>None</code></em>)</p>
</blockquote>

<pre><code>Set logger.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Usage-example">Usage example<a class="anchor-link" href="#Usage-example"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="test_set_logger" class="doc_header"><code>test_set_logger</code><a href="https://github.com/Jaume-JCI/block-types/tree/main/block_types/tests/utils/test_utils.py#L35" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>test_set_logger</code>()</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#@pytest.mark.reference_fails</span>
<span class="k">def</span> <span class="nf">test_set_logger</span> <span class="p">():</span>
    <span class="n">path_results</span> <span class="o">=</span> <span class="s1">&#39;test_logger&#39;</span>
    <span class="n">logger</span> <span class="o">=</span> <span class="n">set_logger</span> <span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">path_results</span><span class="o">=</span><span class="n">path_results</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span> <span class="p">(</span><span class="s1">&#39;test_logger&#39;</span><span class="p">)</span><span class="o">==</span><span class="p">[</span><span class="s1">&#39;logs.txt&#39;</span><span class="p">]</span>
    <span class="k">assert</span> <span class="n">logger</span><span class="o">.</span><span class="n">level</span><span class="o">==</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span>

    <span class="n">logger</span> <span class="o">=</span> <span class="n">set_logger</span> <span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">path_results</span><span class="o">=</span><span class="n">path_results</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">logger</span><span class="o">.</span><span class="n">level</span><span class="o">==</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span>

    <span class="n">set_verbosity</span> <span class="p">(</span><span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">logger</span><span class="o">.</span><span class="n">level</span><span class="o">==</span><span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span>

    <span class="k">for</span> <span class="n">hdlr</span> <span class="ow">in</span> <span class="n">logger</span><span class="o">.</span><span class="n">handlers</span><span class="p">[:]:</span>  
        <span class="k">assert</span> <span class="n">hdlr</span><span class="o">.</span><span class="n">level</span><span class="o">==</span><span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span>
        
    <span class="n">delete_logger</span> <span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">path_results</span><span class="o">=</span><span class="n">path_results</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span> <span class="p">(</span><span class="s1">&#39;test_logger&#39;</span><span class="p">)</span><span class="o">==</span><span class="p">[]</span>
    
    <span class="n">logger</span> <span class="o">=</span> <span class="n">set_empty_logger</span> <span class="p">()</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">critical</span> <span class="p">(</span><span class="s1">&#39;this does not show up&#39;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span> <span class="p">(</span><span class="s1">&#39;test_logger&#39;</span><span class="p">)</span><span class="o">==</span><span class="p">[]</span>
        
    <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span> <span class="p">(</span><span class="n">path_results</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tst</span><span class="o">.</span><span class="n">run</span> <span class="p">(</span><span class="n">test_set_logger</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s1">&#39;dummy&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">/tmp/ipykernel_63467/4030641049.py</span>(4)<span class="ansi-cyan-fg">test_set_logger</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">      2 </span><span class="ansi-red-fg">#@pytest.mark.reference_fails</span>
<span class="ansi-green-fg">      3 </span><span class="ansi-green-fg">def</span> test_set_logger <span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">----&gt; 4 </span><span class="ansi-red-fg">    </span>path_results <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">&#39;test_logger&#39;</span>
<span class="ansi-green-fg">      5 </span><span class="ansi-red-fg">    </span>logger <span class="ansi-blue-fg">=</span> set_logger <span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;test&#39;</span><span class="ansi-blue-fg">,</span> path_results<span class="ansi-blue-fg">=</span>path_results<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">      6 </span><span class="ansi-red-fg">    </span><span class="ansi-green-fg">assert</span> os<span class="ansi-blue-fg">.</span>listdir <span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;test_logger&#39;</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">==</span><span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#39;logs.txt&#39;</span><span class="ansi-blue-fg">]</span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Breakpoint 3 at /tmp/ipykernel_63467/500908706.py:2
</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">/tmp/ipykernel_63467/500908706.py</span>(3)<span class="ansi-cyan-fg">set_empty_logger</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">      1 </span><span class="ansi-red-fg">#export</span>
<span class="ansi-red-intense-fg ansi-bold">3</span><span class="ansi-green-fg">     2 </span><span class="ansi-green-fg">def</span> set_empty_logger <span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">----&gt; 3 </span><span class="ansi-red-fg">    </span><span class="ansi-green-fg">return</span> set_logger <span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;no_logging&#39;</span><span class="ansi-blue-fg">,</span> stdout<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span> filename<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> verbose<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">)</span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>--Call--
&gt; <span class="ansi-green-fg">/tmp/ipykernel_63467/3883365675.py</span>(2)<span class="ansi-cyan-fg">set_logger</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">      1 </span><span class="ansi-red-fg">#export</span>
<span class="ansi-green-fg">----&gt; 2 </span><span class="ansi-red-fg">def set_logger (name, path_results=&#39;log&#39;, stdout=True,
</span><span class="ansi-green-fg">      3 </span><span class="ansi-red-fg">                </span>mode<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&#39;a&#39;</span><span class="ansi-blue-fg">,</span> just_message <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span> filename<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&#39;logs.txt&#39;</span><span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">      4 </span><span class="ansi-red-fg">                </span>logging_level<span class="ansi-blue-fg">=</span>logging<span class="ansi-blue-fg">.</span>DEBUG<span class="ansi-blue-fg">,</span> verbose<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> verbose_out<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">      5 </span><span class="ansi-red-fg">                print_path=False):
</span>
</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-green-fg">----&gt; 2 </span><span class="ansi-red-fg">def set_logger (name, path_results=&#39;log&#39;, stdout=True,
</span><span class="ansi-green-intense-fg ansi-bold">      3 </span>                mode<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&#39;a&#39;</span><span class="ansi-blue-fg">,</span> just_message <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span> filename<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&#39;logs.txt&#39;</span><span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">      4 </span>                logging_level<span class="ansi-blue-fg">=</span>logging<span class="ansi-blue-fg">.</span>DEBUG<span class="ansi-blue-fg">,</span> verbose<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> verbose_out<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">      5 </span>                print_path=False):
<span class="ansi-green-intense-fg ansi-bold">      6 </span>    <span class="ansi-blue-fg">&#34;&#34;&#34;Set logger.&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">      7 </span>    logger <span class="ansi-blue-fg">=</span> logging<span class="ansi-blue-fg">.</span>getLogger<span class="ansi-blue-fg">(</span>name<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      8 </span>    <span class="ansi-green-fg">if</span> verbose <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">      9 </span>        logging_level <span class="ansi-blue-fg">=</span> get_logging_level <span class="ansi-blue-fg">(</span>verbose<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     10 </span>    <span class="ansi-green-fg">if</span> verbose_out <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     11 </span>        logging_level_out <span class="ansi-blue-fg">=</span> get_logging_level <span class="ansi-blue-fg">(</span>verbose_out<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     12 </span>    <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     13 </span>        logging_level_out <span class="ansi-blue-fg">=</span> logging_level
<span class="ansi-green-intense-fg ansi-bold">     14 </span>    logger<span class="ansi-blue-fg">.</span>setLevel<span class="ansi-blue-fg">(</span>logging_level<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     15 </span>
<span class="ansi-green-intense-fg ansi-bold">     16 </span>    <span class="ansi-green-fg">for</span> hdlr <span class="ansi-green-fg">in</span> logger<span class="ansi-blue-fg">.</span>handlers<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">:</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">:</span>  <span class="ansi-red-fg"># remove all old handlers</span>
<span class="ansi-green-intense-fg ansi-bold">     17 </span>        logger<span class="ansi-blue-fg">.</span>removeHandler<span class="ansi-blue-fg">(</span>hdlr<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     18 </span>
<span class="ansi-green-intense-fg ansi-bold">     19 </span>    <span class="ansi-red-fg">#if not logger.hasHandlers():</span>
<span class="ansi-green-intense-fg ansi-bold">     20 </span>
<span class="ansi-green-intense-fg ansi-bold">     21 </span>    <span class="ansi-red-fg"># Create handlers</span>
<span class="ansi-green-intense-fg ansi-bold">     22 </span>    <span class="ansi-green-fg">if</span> stdout<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     23 </span>        c_handler <span class="ansi-blue-fg">=</span> logging<span class="ansi-blue-fg">.</span>StreamHandler<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     24 </span>        c_handler<span class="ansi-blue-fg">.</span>setLevel<span class="ansi-blue-fg">(</span>logging_level_out<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     25 </span>        c_format <span class="ansi-blue-fg">=</span> logging<span class="ansi-blue-fg">.</span>Formatter<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;%(message)s&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     26 </span>        c_handler<span class="ansi-blue-fg">.</span>setFormatter<span class="ansi-blue-fg">(</span>c_format<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     27 </span>        logger<span class="ansi-blue-fg">.</span>addHandler<span class="ansi-blue-fg">(</span>c_handler<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     28 </span>
<span class="ansi-green-intense-fg ansi-bold">     29 </span>    <span class="ansi-green-fg">if</span> filename <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span> <span class="ansi-green-fg">and</span> path_results <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     30 </span>        os<span class="ansi-blue-fg">.</span>makedirs<span class="ansi-blue-fg">(</span>path_results<span class="ansi-blue-fg">,</span> exist_ok<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     31 </span>        path_to_log_file <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">f&#39;{path_results}/{filename}&#39;</span>
<span class="ansi-green-intense-fg ansi-bold">     32 </span>        <span class="ansi-red-fg">#pdb.set_trace()</span>
<span class="ansi-green-intense-fg ansi-bold">     33 </span>        <span class="ansi-green-fg">if</span> print_path<span class="ansi-blue-fg">:</span> print <span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">f&#39;log written in {os.path.abspath(path_to_log_file)}&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     34 </span>        f_handler <span class="ansi-blue-fg">=</span> logging<span class="ansi-blue-fg">.</span>FileHandler <span class="ansi-blue-fg">(</span>path_to_log_file<span class="ansi-blue-fg">,</span> mode <span class="ansi-blue-fg">=</span> mode<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     35 </span>        f_handler<span class="ansi-blue-fg">.</span>setLevel<span class="ansi-blue-fg">(</span>logging_level<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     36 </span>        <span class="ansi-green-fg">if</span> just_message<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     37 </span>            f_format <span class="ansi-blue-fg">=</span> logging<span class="ansi-blue-fg">.</span>Formatter<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;%(asctime)s - %(message)s&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     38 </span>        <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     39 </span>            f_format <span class="ansi-blue-fg">=</span> logging<span class="ansi-blue-fg">.</span>Formatter<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;%(asctime)s - %(name)s - %(levelname)s {%(filename)s:%(funcName)s:%(lineno)d} - %(message)s&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     40 </span>        f_handler<span class="ansi-blue-fg">.</span>setFormatter<span class="ansi-blue-fg">(</span>f_format<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     41 </span>        logger<span class="ansi-blue-fg">.</span>addHandler<span class="ansi-blue-fg">(</span>f_handler<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     42 </span>    <span class="ansi-red-fg">#logger.propagate = 0</span>
<span class="ansi-green-intense-fg ansi-bold">     43 </span>    logger<span class="ansi-blue-fg">.</span>propagate <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">False</span>
<span class="ansi-green-intense-fg ansi-bold">     44 </span>
<span class="ansi-green-intense-fg ansi-bold">     45 </span>    <span class="ansi-green-fg">return</span> logger

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Breakpoint 4 at /tmp/ipykernel_63467/3883365675.py:22
</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">/tmp/ipykernel_63467/3883365675.py</span>(22)<span class="ansi-cyan-fg">set_logger</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">     20 </span>
<span class="ansi-green-fg">     21 </span><span class="ansi-red-fg">    </span><span class="ansi-red-fg"># Create handlers</span>
<span class="ansi-red-intense-fg ansi-bold">4</span><span class="ansi-green-fg">--&gt; 22 </span><span class="ansi-red-fg">    </span><span class="ansi-green-fg">if</span> stdout<span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">     23 </span><span class="ansi-red-fg">        </span>c_handler <span class="ansi-blue-fg">=</span> logging<span class="ansi-blue-fg">.</span>StreamHandler<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">     24 </span><span class="ansi-red-fg">        </span>c_handler<span class="ansi-blue-fg">.</span>setLevel<span class="ansi-blue-fg">(</span>logging_level_out<span class="ansi-blue-fg">)</span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[]
</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">/tmp/ipykernel_63467/3883365675.py</span>(29)<span class="ansi-cyan-fg">set_logger</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">     27 </span><span class="ansi-red-fg">        </span>logger<span class="ansi-blue-fg">.</span>addHandler<span class="ansi-blue-fg">(</span>c_handler<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">     28 </span>
<span class="ansi-green-fg">---&gt; 29 </span><span class="ansi-red-fg">    </span><span class="ansi-green-fg">if</span> filename <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span> <span class="ansi-green-fg">and</span> path_results <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">     30 </span><span class="ansi-red-fg">        </span>os<span class="ansi-blue-fg">.</span>makedirs<span class="ansi-blue-fg">(</span>path_results<span class="ansi-blue-fg">,</span> exist_ok<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">     31 </span><span class="ansi-red-fg">        </span>path_to_log_file <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">f&#39;{path_results}/{filename}&#39;</span>

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">/tmp/ipykernel_63467/3883365675.py</span>(43)<span class="ansi-cyan-fg">set_logger</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">     41 </span><span class="ansi-red-fg">        </span>logger<span class="ansi-blue-fg">.</span>addHandler<span class="ansi-blue-fg">(</span>f_handler<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">     42 </span><span class="ansi-red-fg">    </span><span class="ansi-red-fg">#logger.propagate = 0</span>
<span class="ansi-green-fg">---&gt; 43 </span><span class="ansi-red-fg">    </span>logger<span class="ansi-blue-fg">.</span>propagate <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">False</span>
<span class="ansi-green-fg">     44 </span>
<span class="ansi-green-fg">     45 </span><span class="ansi-red-fg">    </span><span class="ansi-green-fg">return</span> logger

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt; <span class="ansi-green-fg">/tmp/ipykernel_63467/3883365675.py</span>(45)<span class="ansi-cyan-fg">set_logger</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">     41 </span><span class="ansi-red-fg">        </span>logger<span class="ansi-blue-fg">.</span>addHandler<span class="ansi-blue-fg">(</span>f_handler<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">     42 </span><span class="ansi-red-fg">    </span><span class="ansi-red-fg">#logger.propagate = 0</span>
<span class="ansi-green-fg">     43 </span><span class="ansi-red-fg">    </span>logger<span class="ansi-blue-fg">.</span>propagate <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">False</span>
<span class="ansi-green-fg">     44 </span>
<span class="ansi-green-fg">---&gt; 45 </span><span class="ansi-red-fg">    </span><span class="ansi-green-fg">return</span> logger

</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[]
</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>hello
</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>hello
</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>False
</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>hello
</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[]
</pre>
</div>
</div>

<div class="output_area">


</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>hello
</pre>
</div>
</div>

<div class="output_area">


</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="remove_previous_results">remove_previous_results<a class="anchor-link" href="#remove_previous_results"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="remove_previous_results" class="doc_header"><code>remove_previous_results</code><a href="https://github.com/Jaume-JCI/block-types/tree/main/block_types/utils/utils.py#L132" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>remove_previous_results</code>(<strong><code>path_results</code></strong>=<em><code>None</code></em>)</p>
</blockquote>

<pre><code>Remove folder containing previous results, if exists.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="set_tf_loglevel">set_tf_loglevel<a class="anchor-link" href="#set_tf_loglevel"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="set_tf_loglevel" class="doc_header"><code>set_tf_loglevel</code><a href="https://github.com/Jaume-JCI/block-types/tree/main/block_types/utils/utils.py#L138" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>set_tf_loglevel</code>(<strong><code>level</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Usage-example">Usage example<a class="anchor-link" href="#Usage-example"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="test_set_tf_loglevel" class="doc_header"><code>test_set_tf_loglevel</code><a href="https://github.com/Jaume-JCI/block-types/tree/main/block_types/tests/utils/test_utils.py#L61" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>test_set_tf_loglevel</code>()</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#@pytest.mark.reference_fails</span>
<span class="k">def</span> <span class="nf">test_set_tf_loglevel</span> <span class="p">():</span>
    <span class="n">set_tf_loglevel</span> <span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;tensorflow&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">getEffectiveLevel</span><span class="p">()</span><span class="o">==</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tst</span><span class="o">.</span><span class="n">run</span> <span class="p">(</span><span class="n">test_set_tf_loglevel</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s1">&#39;dummy&#39;</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>running test_set_tf_loglevel
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="store_attrs">store_attrs<a class="anchor-link" href="#store_attrs"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="_store_attr">_store_attr<a class="anchor-link" href="#_store_attr"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="argnames" class="doc_header"><code>argnames</code><a href="https://github.com/Jaume-JCI/block-types/tree/main/block_types/utils/utils.py#L157" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>argnames</code>(<strong><code>f</code></strong>, <strong><code>frame</code></strong>=<em><code>False</code></em>)</p>
</blockquote>

<pre><code>Names of arguments to function or frame `f`</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="obtain_class_specific_attrs">obtain_class_specific_attrs<a class="anchor-link" href="#obtain_class_specific_attrs"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_specific_dict_param" class="doc_header"><code>get_specific_dict_param</code><a href="https://github.com/Jaume-JCI/block-types/tree/main/block_types/utils/utils.py#L175" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_specific_dict_param</code>(<strong>**<code>kwargs</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="obtain_class_specific_attrs" class="doc_header"><code>obtain_class_specific_attrs</code><a href="https://github.com/Jaume-JCI/block-types/tree/main/block_types/utils/utils.py#L199" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>obtain_class_specific_attrs</code>(<strong>**<code>kwargs</code></strong>)</p>
</blockquote>

<pre><code>Overwrites parameters in kwargs with those found in a dictionary of the same name
given to this component.

Checks if there is a parameter whose name is the name of the class or the name given
to this component. In that case, it overwrites the parameters in kwargs with those
found in that dictionary. The parameters in kwargs can be used as *global* parameters
for multiple components, while parameters specific of one component can be set using
a dictionary with the name of that component. See example below.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="get_hierarchy_level">get_hierarchy_level<a class="anchor-link" href="#get_hierarchy_level"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_hierarchy_level" class="doc_header"><code>get_hierarchy_level</code><a href="https://github.com/Jaume-JCI/block-types/tree/main/block_types/utils/utils.py#L219" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_hierarchy_level</code>(<strong><code>base_class</code></strong>=<em><code>object</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="test-get_hierarchy_level">test get_hierarchy_level<a class="anchor-link" href="#test-get_hierarchy_level"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="test_get_hierarchy" class="doc_header"><code>test_get_hierarchy</code><a href="https://github.com/Jaume-JCI/block-types/tree/main/block_types/tests/utils/test_utils.py#L67" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>test_get_hierarchy</code>()</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#@pytest.mark.reference_fails</span>
<span class="k">def</span> <span class="nf">test_get_hierarchy</span> <span class="p">():</span>
    <span class="k">def</span> <span class="nf">f</span> <span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">B</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">A</span> <span class="p">():</span>
        <span class="k">def</span> <span class="fm">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hierarchy_level</span> <span class="o">=</span> <span class="n">get_hierarchy_level</span><span class="p">(</span><span class="n">base_class</span><span class="o">=</span><span class="n">A</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">B</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
        <span class="k">def</span> <span class="fm">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span> <span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ab</span> <span class="o">=</span> <span class="n">A</span> <span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="n">B</span><span class="p">):</span>
        <span class="k">def</span> <span class="fm">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span> <span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">class</span> <span class="nc">D</span><span class="p">(</span><span class="n">C</span><span class="p">):</span>
        <span class="k">def</span> <span class="fm">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span> <span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">c</span> <span class="o">=</span> <span class="n">C</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="p">()</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">B</span><span class="p">()</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">D</span><span class="p">()</span>

    <span class="k">assert</span> <span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">hierarchy_level</span><span class="o">==</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">b</span><span class="o">.</span><span class="n">hierarchy_level</span><span class="o">==</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">c</span><span class="o">.</span><span class="n">hierarchy_level</span><span class="o">==</span><span class="mi">0</span>
            <span class="ow">and</span> <span class="n">c</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">hierarchy_level</span><span class="o">==</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">c</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">hierarchy_level</span><span class="o">==</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">c</span><span class="o">.</span><span class="n">ab</span><span class="o">.</span><span class="n">hierarchy_level</span><span class="o">==</span><span class="mi">1</span> 
            <span class="ow">and</span> <span class="n">c</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">ab</span><span class="o">.</span><span class="n">hierarchy_level</span><span class="o">==</span><span class="mi">2</span> 
            <span class="ow">and</span> <span class="n">d</span><span class="o">.</span><span class="n">hierarchy_level</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">d</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">hierarchy_level</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">d</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">hierarchy_level</span> <span class="o">==</span> <span class="mi">1</span>
            <span class="ow">and</span> <span class="n">d</span><span class="o">.</span><span class="n">ab</span><span class="o">.</span><span class="n">hierarchy_level</span> <span class="o">==</span> <span class="mi">1</span> 
            <span class="ow">and</span> <span class="n">d</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">hierarchy_level</span><span class="o">==</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">d</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">ab</span><span class="o">.</span><span class="n">hierarchy_level</span><span class="o">==</span><span class="mi">2</span> <span class="ow">and</span> <span class="n">d</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">ab</span><span class="o">.</span><span class="n">hierarchy_level</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tst</span><span class="o">.</span><span class="n">run</span> <span class="p">(</span><span class="n">test_get_hierarchy</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s1">&#39;dummy&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>running test_get_hierarchy
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="replace_attr_and_store">replace_attr_and_store<a class="anchor-link" href="#replace_attr_and_store"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="replace_attr_and_store" class="doc_header"><code>replace_attr_and_store</code><a href="https://github.com/Jaume-JCI/block-types/tree/main/block_types/utils/utils.py#L242" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>replace_attr_and_store</code>(<strong><code>names</code></strong>=<em><code>None</code></em>, <strong><code>but</code></strong>=<em><code>''</code></em>, <strong><code>store_args</code></strong>=<em><code>None</code></em>, <strong><code>recursive</code></strong>=<em><code>True</code></em>, <strong><code>base_class</code></strong>=<em><code>object</code></em>, <strong><code>replace_generic_attr</code></strong>=<em><code>True</code></em>, <strong><code>overwrite</code></strong>=<em><code>False</code></em>, <strong><code>error_if_present</code></strong>=<em><code>False</code></em>, <strong><code>ignore</code></strong>=<em><code>set()</code></em>, <strong><code>overwrite_name</code></strong>=<em><code>True</code></em>, <strong><code>include_first</code></strong>=<em><code>False</code></em>, <strong>**<code>attrs</code></strong>)</p>
</blockquote>

<pre><code>Replaces generic attributes and stores them into attrs in `self`.

If kwargs contains an attribute called the same way as the class of
self, all the keys in that dictionary are considered class-specific
attributes whose value overwrites any attribute in kwargs of the same
name.

The function is called recursively in the hierarchy of parent classes,
from the leaf to the root class, until it reaches an ascendant that
is not an instance of `base_class`.

Most of the implementation is taken from fastcore library, `store_attrs`
function.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="test-replace_attr_and_store">test replace_attr_and_store<a class="anchor-link" href="#test-replace_attr_and_store"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ignore</span><span class="o">=</span><span class="nb">set</span><span class="p">()</span>
<span class="n">ignore</span><span class="o">.</span><span class="n">update</span> <span class="p">({</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">})</span>
<span class="n">ignore</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{3, 4}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="test_replace_attr_and_store" class="doc_header"><code>test_replace_attr_and_store</code><a href="https://github.com/Jaume-JCI/block-types/tree/main/block_types/tests/utils/test_utils.py#L104" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>test_replace_attr_and_store</code>()</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#@pytest.mark.reference_fails</span>
<span class="k">def</span> <span class="nf">test_replace_attr_and_store</span> <span class="p">():</span>
    <span class="k">def</span> <span class="nf">f</span> <span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">B</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">A</span> <span class="p">():</span>
        <span class="k">def</span> <span class="fm">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="n">replace_attr_and_store</span> <span class="p">(</span><span class="n">base_class</span><span class="o">=</span><span class="n">A</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">B</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
        <span class="k">def</span> <span class="fm">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span> <span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ab</span> <span class="o">=</span> <span class="n">A</span> <span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
        <span class="k">def</span> <span class="fm">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span> <span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="p">()</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">B</span><span class="p">()</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>

    <span class="k">assert</span> <span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="o">==</span><span class="mi">3</span> <span class="ow">and</span> <span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">==</span><span class="mi">10</span> <span class="ow">and</span> <span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">==</span><span class="mi">3</span> <span class="ow">and</span> <span class="n">c</span><span class="o">.</span><span class="n">z</span><span class="o">==</span><span class="mi">100</span> <span class="ow">and</span> <span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="o">==</span><span class="mi">3</span> <span class="ow">and</span> <span class="n">c</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="o">==</span><span class="mi">3</span> <span class="ow">and</span> <span class="n">c</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">==</span><span class="mi">10</span> <span class="ow">and</span> <span class="n">c</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">==</span><span class="mi">3</span>

    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">):</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">):</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">):</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">):</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">):</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">ab</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
        
    <span class="c1"># **************************************************</span>
    <span class="c1"># test changing the argument</span>
    <span class="c1"># **************************************************</span>
    <span class="k">def</span> <span class="nf">f2</span> <span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">y</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">y</span>
        <span class="k">return</span> <span class="n">B2</span> <span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">A2</span> <span class="p">():</span>
        <span class="k">def</span> <span class="fm">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="n">x</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1"> world&#39;</span>
            <span class="n">replace_attr_and_store</span> <span class="p">(</span><span class="n">base_class</span><span class="o">=</span><span class="n">A2</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">B2</span> <span class="p">(</span><span class="n">A2</span><span class="p">):</span>
        <span class="k">def</span> <span class="fm">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span> <span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ab</span> <span class="o">=</span> <span class="n">A2</span> <span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">C2</span> <span class="p">(</span><span class="n">A2</span><span class="p">):</span>
        <span class="k">def</span> <span class="fm">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span> <span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">A2</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">f2</span> <span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">A2</span><span class="p">()</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">B2</span><span class="p">()</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">C2</span><span class="p">()</span>
    <span class="k">assert</span> <span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">ab</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="s1">&#39;hello world&#39;</span><span class="p">,</span> <span class="s1">&#39;hello world&#39;</span><span class="p">,</span> <span class="s1">&#39;hello world&#39;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">c</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">==</span> <span class="mi">20</span>

    <span class="n">a</span> <span class="o">=</span> <span class="n">A2</span> <span class="p">(</span><span class="s1">&#39;hey&#39;</span><span class="p">)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">B2</span> <span class="p">()</span>
    <span class="k">assert</span> <span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">ab</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="s1">&#39;hey world&#39;</span><span class="p">,</span> <span class="s1">&#39;hello world&#39;</span><span class="p">,</span> <span class="s1">&#39;hello world&#39;</span><span class="p">)</span>

    <span class="n">c</span> <span class="o">=</span> <span class="n">C2</span> <span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Hi&#39;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;Hi world&#39;</span><span class="p">)</span>
    
    <span class="c1"># **************************************************</span>
    <span class="c1"># test error_if_present</span>
    <span class="c1"># **************************************************</span>
    
    <span class="k">def</span> <span class="nf">f3</span> <span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">B</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">A3</span> <span class="p">():</span>
        <span class="k">def</span> <span class="fm">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ignore</span><span class="o">=</span><span class="nb">set</span><span class="p">(),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="n">replace_attr_and_store</span> <span class="p">(</span><span class="n">base_class</span><span class="o">=</span><span class="n">A3</span><span class="p">,</span> <span class="n">error_if_present</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                    <span class="n">ignore</span><span class="o">=</span><span class="n">ignore</span><span class="p">,</span> <span class="n">but</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">B3</span><span class="p">(</span><span class="n">A3</span><span class="p">):</span>
        <span class="k">def</span> <span class="fm">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span> <span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ab</span> <span class="o">=</span> <span class="n">A3</span> <span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            
    
    <span class="n">a</span> <span class="o">=</span> <span class="n">A3</span><span class="p">()</span>
    
    <span class="n">b</span> <span class="o">=</span> <span class="n">B3</span><span class="p">()</span>
    
    <span class="n">b2</span> <span class="o">=</span> <span class="n">B3</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    
    <span class="k">assert</span> <span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="o">==</span><span class="mi">3</span> <span class="ow">and</span> <span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">==</span><span class="mi">10</span> <span class="ow">and</span> <span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">==</span><span class="mi">3</span> <span class="ow">and</span> <span class="n">b</span><span class="o">.</span><span class="n">ab</span><span class="o">.</span><span class="n">x</span><span class="o">==</span><span class="mi">3</span> <span class="ow">and</span> <span class="n">b2</span><span class="o">.</span><span class="n">x</span><span class="o">==</span><span class="mi">5</span> <span class="ow">and</span> <span class="n">b2</span><span class="o">.</span><span class="n">y</span><span class="o">==</span><span class="mi">20</span> <span class="ow">and</span> <span class="n">b2</span><span class="o">.</span><span class="n">ab</span><span class="o">.</span><span class="n">x</span><span class="o">==</span><span class="mi">5</span>
    
    <span class="c1"># *******************</span>
    <span class="c1"># test using same field in B4 and in A3, but</span>
    <span class="c1"># B4 passes that value to A3 in super()</span>
    <span class="c1"># *****************</span>
    <span class="k">class</span> <span class="nc">B4</span><span class="p">(</span><span class="n">A3</span><span class="p">):</span>
        <span class="k">def</span> <span class="fm">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span> <span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ab</span> <span class="o">=</span> <span class="n">A3</span> <span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="n">b3</span> <span class="o">=</span> <span class="n">B4</span> <span class="p">()</span>
    <span class="k">assert</span> <span class="n">b3</span><span class="o">.</span><span class="n">x</span><span class="o">==</span><span class="mi">30</span> <span class="ow">and</span> <span class="n">b3</span><span class="o">.</span><span class="n">ab</span><span class="o">.</span><span class="n">x</span><span class="o">==</span><span class="mi">3</span> <span class="ow">and</span> <span class="n">b3</span><span class="o">.</span><span class="n">y</span><span class="o">==</span><span class="mi">10</span>
    
    <span class="c1"># *******************</span>
    <span class="c1"># test using same field in B4 and in A3, but</span>
    <span class="c1"># B4 passes that value to A3 in super(),</span>
    <span class="c1"># after modifying it</span>
    <span class="c1"># *****************</span>
    <span class="k">class</span> <span class="nc">B5</span><span class="p">(</span><span class="n">A3</span><span class="p">):</span>
        <span class="k">def</span> <span class="fm">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="mi">2</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span> <span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ab</span> <span class="o">=</span> <span class="n">A3</span> <span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="n">b3</span> <span class="o">=</span> <span class="n">B5</span> <span class="p">()</span>
    <span class="k">assert</span> <span class="n">b3</span><span class="o">.</span><span class="n">x</span><span class="o">==</span><span class="mi">60</span> <span class="ow">and</span> <span class="n">b3</span><span class="o">.</span><span class="n">ab</span><span class="o">.</span><span class="n">x</span><span class="o">==</span><span class="mi">3</span> <span class="ow">and</span> <span class="n">b3</span><span class="o">.</span><span class="n">y</span><span class="o">==</span><span class="mi">10</span>
    
    <span class="n">b3</span> <span class="o">=</span> <span class="n">B5</span> <span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">b3</span><span class="o">.</span><span class="n">x</span><span class="o">==</span><span class="mi">12</span> <span class="ow">and</span> <span class="n">b3</span><span class="o">.</span><span class="n">ab</span><span class="o">.</span><span class="n">x</span><span class="o">==</span><span class="mi">3</span> <span class="ow">and</span> <span class="n">b3</span><span class="o">.</span><span class="n">y</span><span class="o">==</span><span class="mi">10</span>
    
    <span class="c1"># *******************</span>
    <span class="c1"># test using same field in D and in A3, but</span>
    <span class="c1"># the field is modified in a parent B5</span>
    <span class="c1"># *****************</span>
    <span class="k">class</span> <span class="nc">D</span><span class="p">(</span><span class="n">B5</span><span class="p">):</span>
        <span class="k">def</span> <span class="fm">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span> <span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">B5</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    
    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span> <span class="p">(</span><span class="ne">RuntimeError</span><span class="p">):</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">D</span> <span class="p">()</span>
        
    <span class="n">d</span> <span class="o">=</span> <span class="n">D</span><span class="p">(</span><span class="n">ignore</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">})</span>
    <span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">x</span><span class="o">==</span><span class="mi">80</span> <span class="ow">and</span> <span class="n">d</span><span class="o">.</span><span class="n">y</span><span class="o">==</span><span class="mi">10</span> <span class="ow">and</span> <span class="n">d</span><span class="o">.</span><span class="n">z</span><span class="o">==</span><span class="mi">100</span> <span class="ow">and</span> <span class="n">d</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">==</span><span class="mi">60</span> <span class="ow">and</span> <span class="n">d</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">==</span><span class="mi">10</span>
    
    <span class="n">d</span> <span class="o">=</span> <span class="n">D</span> <span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">ignore</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">})</span>
    <span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">x</span><span class="o">==</span><span class="mi">18</span> <span class="ow">and</span> <span class="n">d</span><span class="o">.</span><span class="n">y</span><span class="o">==</span><span class="mi">10</span> <span class="ow">and</span> <span class="n">d</span><span class="o">.</span><span class="n">z</span><span class="o">==</span><span class="mi">100</span> <span class="ow">and</span> <span class="n">d</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">==</span><span class="mi">60</span> <span class="ow">and</span> <span class="n">d</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">==</span><span class="mi">10</span>
    
    <span class="k">assert</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
    
    <span class="c1"># *******************</span>
    <span class="c1"># test having a field with same name</span>
    <span class="c1"># *******************</span>
    <span class="k">class</span> <span class="nc">C3</span><span class="p">(</span><span class="n">A3</span><span class="p">):</span>
        <span class="k">def</span> <span class="fm">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span> <span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">A3</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">f3</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    
    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span> <span class="p">(</span><span class="ne">RuntimeError</span><span class="p">):</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">C3</span><span class="p">()</span>
        
    <span class="c1"># **************************************************</span>
    <span class="c1"># test overwrite</span>
    <span class="c1"># **************************************************</span>
    <span class="k">class</span> <span class="nc">A4</span> <span class="p">():</span>
        <span class="k">def</span> <span class="fm">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="n">replace_attr_and_store</span> <span class="p">(</span><span class="n">base_class</span><span class="o">=</span><span class="n">A4</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            
    <span class="k">class</span> <span class="nc">C5</span><span class="p">(</span><span class="n">A4</span><span class="p">):</span>
        <span class="k">def</span> <span class="fm">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span> <span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">A4</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            
    <span class="n">c</span> <span class="o">=</span> <span class="n">C5</span> <span class="p">()</span>
    <span class="k">assert</span> <span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="o">==</span> <span class="mi">4</span> <span class="ow">and</span> <span class="n">c</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="o">==</span><span class="mi">3</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tst</span><span class="o">.</span><span class="n">run</span> <span class="p">(</span><span class="n">test_replace_attr_and_store</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s1">&#39;dummy&#39;</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>running test_replace_attr_and_store
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="test-replace_attr_and_store-without-recursiveness">test replace_attr_and_store without recursiveness<a class="anchor-link" href="#test-replace_attr_and_store-without-recursiveness"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="test_replace_attr_and_store_no_rec" class="doc_header"><code>test_replace_attr_and_store_no_rec</code><a href="https://github.com/Jaume-JCI/block-types/tree/main/block_types/tests/utils/test_utils.py#L282" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>test_replace_attr_and_store_no_rec</code>()</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#@pytest.mark.reference_fails</span>
<span class="k">def</span> <span class="nf">test_replace_attr_and_store_no_rec</span> <span class="p">():</span>
    <span class="c1"># test without recursiveness</span>
    <span class="kn">from</span> <span class="nn">sklearn.utils</span> <span class="kn">import</span> <span class="n">Bunch</span>

    <span class="k">def</span> <span class="nf">f</span> <span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">estimator</span> <span class="o">=</span> <span class="n">Bunch</span> <span class="p">()</span>
        <span class="n">replace_attr_and_store</span> <span class="p">(</span><span class="n">recursive</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                <span class="bp">self</span><span class="o">=</span><span class="n">estimator</span><span class="p">,</span> <span class="n">include_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">estimator</span>

    <span class="n">estimator</span> <span class="o">=</span> <span class="n">f</span> <span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>

    <span class="n">stored_args</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;__stored_args__&#39;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">estimator</span><span class="o">==</span><span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">}</span>
    <span class="k">assert</span> <span class="n">stored_args</span> <span class="o">==</span> <span class="n">estimator</span>

    <span class="c1"># test without kwargs</span>
    <span class="k">def</span> <span class="nf">g</span> <span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
        <span class="n">estimator</span> <span class="o">=</span> <span class="n">Bunch</span> <span class="p">()</span>
        <span class="n">replace_attr_and_store</span> <span class="p">(</span><span class="n">recursive</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                <span class="bp">self</span><span class="o">=</span><span class="n">estimator</span><span class="p">,</span> <span class="n">include_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">estimator</span>

    <span class="n">estimator</span> <span class="o">=</span> <span class="n">g</span> <span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>

    <span class="n">stored_args</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;__stored_args__&#39;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">estimator</span><span class="o">==</span><span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">}</span>
    <span class="k">assert</span> <span class="n">stored_args</span> <span class="o">==</span> <span class="n">estimator</span>

    <span class="c1"># test without kwargs and with replace_generic_attr=False</span>
    <span class="k">def</span> <span class="nf">h</span> <span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
        <span class="n">estimator</span> <span class="o">=</span> <span class="n">Bunch</span> <span class="p">()</span>
        <span class="n">replace_attr_and_store</span> <span class="p">(</span><span class="n">recursive</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                <span class="bp">self</span><span class="o">=</span><span class="n">estimator</span><span class="p">,</span> <span class="n">include_first</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">replace_generic_attr</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">estimator</span>

    <span class="n">estimator</span> <span class="o">=</span> <span class="n">h</span> <span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>

    <span class="n">stored_args</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;__stored_args__&#39;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">estimator</span><span class="o">==</span><span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">}</span>
    <span class="k">assert</span> <span class="n">stored_args</span> <span class="o">==</span> <span class="n">estimator</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tst</span><span class="o">.</span><span class="n">run</span> <span class="p">(</span><span class="n">test_replace_attr_and_store_no_rec</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s1">&#39;dummy&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>running test_replace_attr_and_store_no_rec
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

