---

title: Tests


keywords: fastai
sidebar: home_sidebar

summary: "Using pytest together with nbdev"
description: "Using pytest together with nbdev"
nb_path: "nbs/tutorials/tests.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/tutorials/tests.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To make this possible, we follow these steps:</p>
<h4 id="1.-Notebooks">1. Notebooks<a class="anchor-link" href="#1.-Notebooks"> </a></h4><ul>
<li>For each notebook <code>x.y.ipynb</code>, we create another notebook <code>test.x.y.ipynb</code></li>
<li>In <code>test.x.y.ipynb</code>:<ul>
<li>We import the functions and classes from x.y.ipynb that we are going to test</li>
<li>We define all the necessary fixtures with name parameter. For example:<div class="highlight"><pre><span></span><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span> <span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;example_data&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">example_fixture</span> <span class="p">():</span>
  <span class="k">return</span> <span class="n">example_data</span> <span class="p">()</span>
</pre></div>
</li>
</ul>
</li>
<li>In <code>x.y.ipynb</code>, every time we write a test in one cell, we export it to <code>test.x.y.ipynb</code>, as follows:<div class="highlight"><pre><span></span><span class="c1"># export test.x.y</span>
</pre></div>
</li>
<li><p>In <code>x.y.ipynb</code>, the tests are run using the TestRunner object:</p>
<ul>
<li><p>At the beginning of the notebook, we import TestRunner and instantiate an object:
  ```python
  from block_types.utils.nbdev_utils import TestRunner
  tst = TestRunner (targets=['my_tag', 'my_second_tag'])</p>
</li>
<li><p>We implement each test as a function:</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">test_function</span> <span class="p">():</span>
      <span class="o">...</span>
</pre></div>
</li>
<li>We run the test using the <code>tst.run</code> method:<div class="highlight"><pre><span></span><span class="n">tst</span><span class="o">.</span><span class="n">run</span> <span class="p">(</span><span class="n">test_function</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s1">&#39;my_tag&#39;</span><span class="p">)</span>
</pre></div>
</li>
</ul>
</li>
</ul>
<h4 id="2.-Files">2. Files<a class="anchor-link" href="#2.-Files"> </a></h4><ol>
<li>In <code>.github/workflows/main.yml</code>, comment out condition using <code>nbdev_diff_nbs</code></li>
<li>In <code>.gitignore</code>, add <em>name_library</em>/test </li>
<li>Either manually, or based on python script:<ul>
<li><code>cp -r *name_library*/test .</code></li>
<li>replace imports to be absolute</li>
</ul>
</li>
</ol>

</div>
</div>
</div>
</div>
 

